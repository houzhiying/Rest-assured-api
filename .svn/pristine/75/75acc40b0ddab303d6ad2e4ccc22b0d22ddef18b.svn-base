package com.vip.apitest.luxury.vlife;

import static com.jayway.restassured.RestAssured.given;
import static org.hamcrest.Matchers.equalTo;

import java.net.URLEncoder;
import java.security.MessageDigest;

import org.databene.benerator.anno.Source;
import org.junit.Test;

import com.jayway.restassured.RestAssured;
import com.vip.apitest.luxury.BaseTestCase;
import com.vip.apitest.luxury.common.CommonMethod;
import com.vip.apitest.utility.MD5Encoder;

public class Brand_updateTest extends BaseTestCase{
	
	@Test
	public void testBrandUpdateAtion_right() throws Exception{
		System.out.println("更新品牌列表的接口");
		RestAssured.urlEncodingEnabled = true;
		String sign = MD5Encoder.encodeByMD5("brand" + "update" + "viplux#123@", MessageDigest.getInstance("MD5"));
		
		given().
			params("sign", sign).
			params("appid", CommonMethod.appid).
			params("brand_id", "1").
			params("name", URLEncoder.encode("品牌名称测试","UTF-8")).
			params("nickname", "test").
			params("title", URLEncoder.encode("品牌标题测试","UTF-8")).
			params("thumbnail", "/upload/p18r5tnc33ceb1dcp14ps182u1vla5.jpg").
			formParam("key", "viplux#123@").
			urlEncodingEnabled(false).
		when().
			post(CommonMethod.vlife_uri+"/brand/update/").
		then().
			statusCode(200).
			body("code", equalTo(1)).
			body("data", equalTo("更新成功"));
	}
	
	@Test
	@Source("data/vlife/brand_update_error.csv")
	public void testBrandUpdateAtion_error(String testName, String brand_id, String name, String title, String nickname, String key, int code, String msg) throws Exception{
		System.out.println(testName);
		String sign = MD5Encoder.encodeByMD5("brand" + "update" + "viplux#123@", MessageDigest.getInstance("MD5"));
		given().
			params("sign", sign).
			params("appid", CommonMethod.appid).
			params("brand_id", brand_id).
			params("name", name).
			params("nickname", nickname).
			params("title", title).
			params("thumbnail", "/upload/p18r5tnc33ceb1dcp14ps182u1vla5.jpg").
			formParam("key", key).
		when().
			post(CommonMethod.vlife_uri+"/brand/update/").
		then().
			statusCode(200).
			body("code", equalTo(code)).
			body("msg", equalTo(msg));
	}
}
