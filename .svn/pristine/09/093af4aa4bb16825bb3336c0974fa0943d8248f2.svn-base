package com.vip.apitest.luxury.vlife;

import static com.jayway.restassured.RestAssured.given;
import static com.jayway.restassured.module.jsv.JsonSchemaValidator.matchesJsonSchema;
import static org.hamcrest.Matchers.equalTo;

import java.io.InputStream;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

import org.junit.Before;
import org.junit.Test;

import com.jayway.restassured.RestAssured;
import com.vip.apitest.luxury.BaseTestCase;
import com.vip.apitest.luxury.common.CommonMethod;
import com.vip.apitest.utility.MD5Encoder;

public class RecommendIndexTest extends BaseTestCase{
	
	@Before
	public void setUp(){
		RestAssured.baseURI = "http://mapp.vipfashion.com/oi";
		RestAssured.port = 80;
		
	}
	
	/**
	 * 获取推荐品牌资讯
	 * 正例
	 * 校验schema
	 * 
	 */
	@Test
	public void testRecommendIndex() throws NoSuchAlgorithmException{
		InputStream jsonschema = Thread.currentThread().getContextClassLoader().getResourceAsStream("json/recommend_home.json");
		String sign = MD5Encoder.encodeByMD5("recommend" + "index" + "viplux#123@", MessageDigest.getInstance("MD5"));
        given().
            params("sign", sign).
            params("appid", CommonMethod.appid).
            params("i", 0).
        when().
            get("/recommend/index/").prettyPrint();
//        then().
//			statusCode(200).
//			body("code", equalTo(1)).
//			body(matchesJsonSchema(jsonschema));
	}
	
	/**
	 * 获取更多品牌资讯
	 * 正例
	 * 校验schema
	 * 
	 */
	@Test
	public void testRecommendIndex01() throws NoSuchAlgorithmException{
		InputStream jsonschema = Thread.currentThread().getContextClassLoader().getResourceAsStream("json/recommend_home.json");
		String sign = MD5Encoder.encodeByMD5("recommend" + "index" + "viplux#123@", MessageDigest.getInstance("MD5"));
        given().
            params("sign", sign).
            params("appid", CommonMethod.appid).
            params("i", 1).
        when().
            get("/recommend/index/").prettyPrint();
//        then().
//			statusCode(200).
//			body("code", equalTo(1)).
//			body(matchesJsonSchema(jsonschema));
	}
	
	
	/**
	 * 获取单个品牌资讯
	 * 正例
	 * 校验schema
	 * 
	 */
	@Test
	public void testRecommendIndex02() throws NoSuchAlgorithmException{
		InputStream jsonschema = Thread.currentThread().getContextClassLoader().getResourceAsStream("json/recommend_home.json");
		String sign = MD5Encoder.encodeByMD5("recommend" + "index" + "viplux#123@", MessageDigest.getInstance("MD5"));
        given().
            params("sign", sign).
            params("appid", CommonMethod.appid).
            params("i", 2).
            params("brand_id", 8888).
        when().
            get("/recommend/index/").prettyPrint();
//        then().
//			statusCode(200).
//			body("code", equalTo(1)).
//			body(matchesJsonSchema(jsonschema));
	}
	

}
