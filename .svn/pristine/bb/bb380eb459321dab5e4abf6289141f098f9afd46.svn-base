package com.vip.apitest.luxury.magento;

import static com.jayway.restassured.RestAssured.given;
import static org.hamcrest.Matchers.containsString;
import static org.hamcrest.Matchers.equalTo;

import org.databene.benerator.anno.Source;
import org.junit.Assert;
import org.junit.Test;

import com.vip.apitest.luxury.BaseTestCase;


public class AddressAddTest extends BaseTestCase{
	//UserName:huangwj123@126.com
	//PWD:123456789aaa
	private String accesstoken = "688b0ed90a119c0597ad0590977a309a52b5f3e9";
	private String uid = "12485341";
	
	@Test
	public void testAddAddress(){
		System.out.println("添加地址");
		
		String firstname = "张";
		String lastname = "李四";
		String city = "上海";
		String telephone = "12345678910";
		String street = "[\"上海浦东新区\"]";
		String delivery_time_type = "2";
		String country_id = "CN";
		String postcode = "200000";
		boolean is_default_shipping = true;
		
		String 	addressInfo ="{\"firstname\" :\"" + firstname + "\",";
				addressInfo += "\"lastname\":\"" + lastname + "\",";
				addressInfo += "\"city\":\"" + city + "\",";
				addressInfo += "\"telephone\":\"" + telephone + "\",";
				addressInfo += "\"street\":" + street + ",";
				addressInfo += "\"delivery_time_type\":\"" + delivery_time_type + "\",";
				addressInfo += "\"country_id\":\"" + country_id + "\",";
				addressInfo += "\"postcode\": \"" + postcode + "\",";
				addressInfo += "\"is_default_shipping\":" + is_default_shipping + "}";
				
		
		System.out.println(addressInfo);
		
		String URI = "http://shop-mapp.vipfashion.com/api/rest/customers/"+uid+"/addresses"; 
		given().
           body(addressInfo).
           header("accesstoken", accesstoken).
           header("Content-Type", "application/json; charset=utf-8").
		when().
			post(URI).
		then().
			statusCode(200).
			body("code", equalTo(1));

	}
	
	@Test
	@Source("data/magento/Add_Address_null.csv")
	public void testAddAddress_null(String firstName, String lastName, String city, String telephone, String street, String delivery_time_type,
									String country_id, String postCode, String is_default_shipping, int code, String message){
		System.out.println("添加地址");
		System.out.println(message);
		
		String 	addressInfo ="{\"firstname\" :\"" + firstName + "\",";
				addressInfo += "\"lastname\":\"" + lastName + "\",";
				addressInfo += "\"city\":\"" + city + "\",";
				addressInfo += "\"telephone\":\"" + telephone + "\",";
				addressInfo += "\"street\":" + street + ",";
				addressInfo += "\"delivery_time_type\":\"" + delivery_time_type + "\",";
				addressInfo += "\"country_id\":\"" + country_id + "\",";
				addressInfo += "\"postcode\": \"" + postCode + "\",";
				addressInfo += "\"is_default_shipping\":" + is_default_shipping + "}";
		
		
		System.out.println(addressInfo);
		
		String str = given().
			body(addressInfo).
			header("accesstoken", accesstoken).
			header("Content-Type", "application/json; charset=utf-8").
		when().
			post("http://shop-mapp.vipfashion.com/api/rest/customers/"+uid+"/addresses").prettyPrint();
		Assert.assertThat(str, containsString(message));
		
	}
	
}
