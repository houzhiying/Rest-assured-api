package com.vip.apitest.utility.db;


import java.sql.*; 

public class ConnectionFactoryForMySql{
	String dbUrl="";
	String dbUser=""; 
	String dbPsw=""; 
	String dbServiceName="";
	Connection conn = null; 
	Statement st = null; 
	ResultSet rs = null; 
	public ConnectionFactoryForMySql(String user,String psw,String host,String port,String serviceName){
		dbUrl = "jdbc:mysql://" + host + ":" + port + "/" + serviceName;
		dbUser = user;
		dbPsw = psw;
	}
	public void DbConnection(){
		try{ 
			Class.forName("com.mysql.jdbc.Driver").newInstance(); 
			conn = DriverManager.getConnection(dbUrl, dbUser, dbPsw);
			st = conn.createStatement(); 
		}
		catch(Exception e){ 
			e.printStackTrace(); 
		}
	}
	public boolean executeUpdate(String sql) 
	{ 
		try 
		{ 
			st.executeUpdate(sql); 
			return true; 
		} 
		catch (SQLException e) 
		{ 
			e.printStackTrace(); 
			return false; 
		} 
	} 
	public ResultSet executeQuery(String sql) 
	{
		rs=null; 
		try{ 
			rs=st.executeQuery(sql); 
		} 
		catch(SQLException e){ 
			e.printStackTrace(); 
		} 
		return rs; 
	} 
	public void close() 
	{ 
		try{ 
			rs.close();
			st.close(); 
			conn.close(); 
		} 
		catch (Exception e){ 
			e.printStackTrace(); 
		} 
	} 
	public static void main(String[] args) 
	{ 
		ConnectionFactoryForMySql conn = new ConnectionFactoryForMySql("hjbill","hjbill","10.232.31.144","3306","information_schema");
		System.out.print(conn.dbUrl);
		ResultSet rs; 
		conn.DbConnection();
		rs = conn.executeQuery("SELECT COLUMN_NAME, DATA_TYPE FROM COLUMNS WHERE TABLE_NAME = 'hj_gateway_msg_20120224'"); 
		try{ 
			while (rs.next()){ 
				System.out.println(rs.getString("COLUMN_NAME")); 
	
			} 
		}catch(Exception e){ 
			///e.printStackTrace(); 
		} 
		conn.close();
	} 
} 