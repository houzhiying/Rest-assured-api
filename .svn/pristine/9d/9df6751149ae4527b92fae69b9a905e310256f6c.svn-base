package com.vip.apitest.luxury.magento;

import static com.jayway.restassured.RestAssured.given;
import static com.jayway.restassured.module.jsv.JsonSchemaValidator.matchesJsonSchema;
import static org.hamcrest.Matchers.equalTo;

import java.io.InputStream;
import java.io.UnsupportedEncodingException;

import org.junit.BeforeClass;
import org.junit.Test;

import com.vip.apitest.luxury.common.CommonMethod;

public class CartGetTest {
	
	@BeforeClass
	public static void init() throws Exception{
		CommonMethod.getUidAndToken();
	}
	
	@Test
	public void testCartGet() throws UnsupportedEncodingException {
		System.out.println("获取购物车中的商品");
		InputStream jsonSchema = Thread.currentThread().getContextClassLoader().getResourceAsStream("json/cart_get.json");
		given().
			header("accesstoken", CommonMethod.token).
		when().
			get(CommonMethod.magento_uri+"/api/rest/checkout/carts/user").
		then().
			statusCode(200).
			body("code", equalTo(1)).
			body(matchesJsonSchema(jsonSchema));
		
	}
}
