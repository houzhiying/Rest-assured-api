package com.vip.apitest.luxury.magento;

import static com.jayway.restassured.RestAssured.given;
import static com.jayway.restassured.module.jsv.JsonSchemaValidator.matchesJsonSchema;
import static org.hamcrest.Matchers.equalTo;

import java.io.InputStream;

import org.databene.benerator.anno.Source;
import org.junit.Test;

import com.vip.apitest.luxury.BaseTestCase;

public class ProductTest extends BaseTestCase{
	
	    @Test
	    @Source("data/vlife/product_detail.csv")
	    public void testGetProductDetailError(String testName,String productID,int responseStatus,int dataCode,String message) throws Exception{
	    	System.out.println(testName);
			String URI = "http://shop-mapp.vipfashion.com/api/rest/products/"+productID;
				given().
//					params("product", "1").
				when().
					get(URI).
				then().
					statusCode(responseStatus).
					body("code",equalTo(dataCode)).
					body("msg",equalTo(message));
	    }
	    
	    @Test
	    public void testGetProductDetail() throws Exception{
	    	System.out.println("根据id或者sku获取商品");
			InputStream jsonschema = Thread.currentThread().getContextClassLoader().getResourceAsStream("json/product_detail.json");
			String productID = "3";
			String URI = "http://shop-mapp.vipfashion.com/api/rest/products/"+productID;
			given().
//				params("product", "1").
			when().
				get(URI).
			then().
			 	statusCode(200).
			 	body("code",equalTo(1)).
			 	body(matchesJsonSchema(jsonschema));			
	    }
}
